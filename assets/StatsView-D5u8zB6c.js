import{r as p,j as s}from"./vendor-react-DBOHU2Gb.js";import{_ as P,u as $,a as R}from"./index-BFwlLuBF.js";const _=(e,n)=>n||e,S={petpn:{uuid:"b40d343b9536455096d614d344e05ef4",username:"petpn",role:"build",isOnline:!0,firstSeen:new Date("2023-01-15T10:00:00Z").getTime(),lastSeen:Date.now(),playTime:350*60*60*1e3+45*60*1e3},djeel:{uuid:"fe9ac36950eb4fe290d6b4de671f4978",username:"djeel",role:"admin",isOnline:!0,firstSeen:new Date("2023-01-15T10:00:00Z").getTime(),lastSeen:Date.now(),playTime:350*60*60*1e3+45*60*1e3}};function T(e){return e?new Date(e).toLocaleDateString():_("stats-na","N/A")}function D(e){if(e==null)return _("stats-na","N/A");let n=Math.floor(e/1e3),i=Math.floor(n/60),m=Math.floor(i/60);return n%=60,i%=60,`${m>0?m+"h ":""}${i>0?i+"m ":""}${n}s`.trim()}function U(e){return!e||e.length!==32?e||"N/A":`${e.substring(0,8)}-${e.substring(8,12)}-${e.substring(12,16)}-${e.substring(16,20)}-${e.substring(20)}`}async function A(e){try{const n=await fetch(`https://api.ashcon.app/mojang/v2/user/${encodeURIComponent(e)}`);if(!n.ok)return null;const i=await n.json();if(i&&i.uuid&&i.username)return{uuid:i.uuid.replace(/-/g,""),name:i.username}}catch{}return null}async function C(e){const n=e.replace(/-/g,""),i="https://corsproxy.io/?",m=`https://sessionserver.mojang.com/session/minecraft/profile/${n}`;try{const d=await fetch(`${i}${m}`);if(!d.ok)return null;const h=await d.json();if(h&&h.name)return{name:h.name}}catch{}return null}function L(e){return e?`https://crafatar.com/skins/${e.replace(/-/g,"")}?default=MHF_Steve`:"img/player-skin.png"}function O(e){const[n,i]=p.useState(e||""),[m,d]=p.useState(!1),[h,g]=p.useState(null),[y,b]=p.useState(null),o=p.useRef(null),t=p.useRef(null),N=p.useCallback(async w=>{const c=(w??n).trim();if(!c){g("empty"),b(null);return}d(!0),g(null);try{let r=null,f=c;const x=c.replace(/-/g,"");if(/^[0-9a-fA-F]{32}$/.test(x)){r=x;const l=await C(r);l!=null&&l.name&&(f=l.name)}else{const l=await A(c);if(l)r=l.uuid,f=l.name;else if(S[c.toLowerCase()]){const j=S[c.toLowerCase()];r=j.uuid,f=j.username}}if(!r||!/^[0-9a-fA-F]{32}$/.test(r)){g("notfound"),b(null),d(!1);return}const a=Object.values(S).find(l=>l.uuid===r),u={uuid:r,displayName:f,role:(a==null?void 0:a.role)||"player",isOnline:(a==null?void 0:a.isOnline)||!1,firstSeen:(a==null?void 0:a.firstSeen)||null,lastSeen:(a==null?void 0:a.lastSeen)||null,playTime:(a==null?void 0:a.playTime)||null,skinUrl:L(r)};b(u)}catch{g("error")}finally{d(!1)}},[n]);return p.useEffect(()=>{e&&N(e)},[]),p.useEffect(()=>{let w=!1;async function c(){var r;if(!(!y||!t.current))try{const[{SkinViewer:f,IdleAnimation:x},a]=await Promise.all([P(()=>import("./skinview-DYgcG9Mm.js").then(v=>v.s),[]),P(()=>import("./skinview-DYgcG9Mm.js").then(v=>v.t),[])]);if(w)return;t.current.innerHTML="";const u=t.current.offsetWidth||200,l=t.current.offsetHeight||300;o.current=new f({width:u,height:l,skin:y.skinUrl,zoom:0}),t.current.appendChild(o.current.canvas),o.current.camera.position.set(0,1.5,42),o.current.camera.lookAt(new a.Vector3(0,.9,0));const j=new x;(r=o.current.animations)!=null&&r.add&&o.current.animations.add(j),j.speed=.6,j.play&&j.play()}catch{}}return c(),()=>{var r;w=!0,(r=o.current)!=null&&r.dispose&&o.current.dispose()}},[y]),{state:{query:n,loading:m,error:h,player:y},actions:{setQuery:i,search:N},utils:{formatDate:T,formatPlayTime:D,formatUUID:U},skinContainerRef:t}}function I(){const e=$(),i=new URLSearchParams(window.location.search).get("member")||"",{state:m,actions:d,utils:h,skinContainerRef:g}=O(i),{query:y,loading:b,error:o,player:t}=m,{setQuery:N,search:w}=d,{formatDate:c,formatPlayTime:r,formatUUID:f}=h;function x(u){try{const l=new URL(window.location.href);u?l.searchParams.set("member",u):l.searchParams.delete("member"),l.hash="#stats",window.history.replaceState({},"",l.toString())}catch{}}async function a(u){u.preventDefault(),x(y.trim()),await w()}return R(),s.jsx("section",{id:"stats",className:"player-stats section-auto-fade",children:s.jsxs("div",{className:"container stats-container",children:[s.jsxs("form",{onSubmit:a,className:"player-search-container",id:"player-search-section",children:[s.jsx("input",{type:"text",id:"player-search-input",value:y,placeholder:e("stats-search-input"),onChange:u=>N(u.target.value),"aria-label":"Player search input"}),s.jsxs("button",{id:"player-search-button",className:"btn btn-primary",type:"submit",children:[s.jsx("i",{className:"fas fa-search"})," ",s.jsx("span",{"data-lang":"stats-search-button",children:e("stats-search-button")})]})]}),o&&s.jsxs("div",{className:`search-message ${o==="notfound"?"error":"info"}`,style:{display:"block"},children:[o==="empty"&&e("stats-na"),o==="notfound"&&e("stats-player-not-found"),o==="error"&&e("stats-search-error")]}),b&&s.jsx("div",{id:"player-profile-loading",style:{display:"flex"},children:s.jsxs("p",{children:[s.jsx("i",{className:"fas fa-spinner fa-spin"})," ",e("stats-loading")]})}),!b&&t&&s.jsxs("div",{className:"player-profile elevated gradient-border hover-scale-sm",id:"player-profile-content",style:{display:"flex"},children:[s.jsx("div",{className:"player-avatar",id:"player-skin-viewer-container",ref:g}),s.jsxs("div",{className:"player-info",children:[s.jsxs("div",{className:"player-role-container",children:[s.jsx("span",{className:`player-role ${t.role==="player"?"member":t.role}`,children:(t.role==="player"?"MEMBER":t.role).toUpperCase()}),s.jsx("h1",{className:"player-username",children:t.displayName}),s.jsx("span",{className:"player-status "+(t.isOnline?"online":"offline"),title:t.isOnline?e("status-online"):e("status-offline")})]}),s.jsxs("div",{className:"player-uuid",children:[s.jsx("span",{"data-lang":"stats-uuid-label",children:e("stats-uuid-label")}),s.jsx("span",{id:"player-uuid-value",children:f(t.uuid)})]}),s.jsxs("div",{className:"player-stats-basic",children:[s.jsxs("div",{className:"stats-item",children:[s.jsx("span",{className:"stats-date",id:"first-seen-date",children:c(t.firstSeen)}),s.jsx("span",{className:"stats-label","data-lang":"stats-first-seen",children:e("stats-first-seen")})]}),s.jsxs("div",{className:"stats-item",children:[s.jsx("span",{className:"stats-date",id:"last-seen-date",children:c(t.lastSeen)}),s.jsx("span",{className:"stats-label","data-lang":"stats-last-seen",children:e("stats-last-seen")})]}),s.jsxs("div",{className:"stats-item",children:[s.jsx("span",{className:"stats-time",id:"play-time",children:r(t.playTime)}),s.jsx("span",{className:"stats-label","data-lang":"stats-play-time",children:e("stats-play-time")})]})]})]})]})]})})}export{I as default};
